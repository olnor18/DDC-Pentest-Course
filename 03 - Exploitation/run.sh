#!/bin/bash
command -v docker >/dev/null 2>&1 || { echo >&2 "I require Docker but it's not installed.  Aborting."; exit 1; }
echo "Stopping running Excercise-Container if any."
docker container stop excercise03 > /dev/null 2>&1
echo "Removing stored Excercise-Container if any."
docker container rm excercise03 > /dev/null 2>&1
echo "Running conainer. If this is the first time running it on this machine, expect about a few minutes for the download to be done."
docker run -e GITLAB_ROOT_PASSWORD="$(openssl rand -hex 64)" --name excercise03 -d ghcr.io/olnor18/ddc-pentesting-exercise03:latest
IP=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' excercise03)
sleep 30
echo "The machine is active on $IP. Expect a few minutes of startup time. There should be more than one open port when it is ready"
